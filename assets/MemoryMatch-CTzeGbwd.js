import{u as z,r as n,j as e,I as S,a as F,b as N,d as $}from"./index-CcjtvQsw.js";import{y as A,r as G,u as H}from"./index-u5fJ2iny.js";import{C as E}from"./CommonHeader-uykeTM-y.js";import{F as R}from"./Footer-C9xXkQ8P.js";import{l as W}from"./lessons-Bu8nnGgm.js";const L=()=>W.flatMap(i=>i.cards),O=i=>{const m=[...i];for(let d=m.length-1;d>0;d--){const o=Math.floor(Math.random()*(d+1));[m[d],m[o]]=[m[o],m[d]]}return m},h=6,K=()=>{const{t:i,i18n:m}=z(),d=n.useMemo(()=>L(),[]),[o,p]=n.useState([]),[u,f]=n.useState([]),[x,y]=n.useState(0),[g,C]=n.useState(0),[M,b]=n.useState(0),[v,I]=n.useState(!1),[P,j]=n.useState(!1),w=s=>{switch(m.language){case"zh-TW":return s.zhTW||s.english;case"zh-CN":return s.zhCN||s.english;default:return s.english}},k=()=>{const s=O(d).slice(0,h),a=[];s.forEach((t,c)=>{a.push({id:"tagalog-".concat(c),content:t.tagalog,type:"tagalog",pairId:t.id,isFlipped:!1,isMatched:!1}),a.push({id:"trans-".concat(c),content:w(t),type:"translation",pairId:t.id,isFlipped:!1,isMatched:!1})}),p(O(a)),f([]),y(0),C(0),b(0),I(!1),j(!1)};n.useEffect(()=>{if(o.length>0&&!v){const s=setInterval(()=>{b(a=>a+1)},1e3);return()=>clearInterval(s)}},[o.length,v]),n.useEffect(()=>{k()},[]),n.useEffect(()=>{if(u.length===2){j(!0),y(l=>l+1);const[s,a]=u,t=o.find(l=>l.id===s),c=o.find(l=>l.id===a);t&&c&&t.pairId===c.pairId&&t.type!==c.type?setTimeout(()=>{p(l=>l.map(r=>r.id===s||r.id===a?{...r,isMatched:!0}:r)),C(l=>{const r=l+1;return r===h&&I(!0),r}),f([]),j(!1)},600):setTimeout(()=>{p(l=>l.map(r=>r.id===s||r.id===a?{...r,isFlipped:!1}:r)),f([]),j(!1)},1e3)}},[u]);const B=s=>{if(P)return;const a=o.find(t=>t.id===s);!a||a.isFlipped||a.isMatched||u.length>=2||(p(t=>t.map(c=>c.id===s?{...c,isFlipped:!0}:c)),f(t=>[...t,s]))},T=s=>{const a=Math.floor(s/60),t=s%60;return"".concat(a,":").concat(t.toString().padStart(2,"0"))};if(v){const s=x<=h+2?3:x<=h+5?2:1;return e.jsxs(S,{children:[e.jsx(E,{title:i("memory.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(F,{className:"ion-padding memory-content",children:e.jsxs("div",{className:"memory-over-container fade-in-up",children:[e.jsxs("div",{className:"memory-over-card",children:[e.jsx("div",{className:"trophy-icon",children:e.jsx(N,{icon:A})}),e.jsx("h2",{children:i("memory.complete")}),e.jsx("p",{className:"memory-over-subtitle",children:i("memory.greatMemory")}),e.jsx("div",{className:"stars-display",children:[1,2,3].map(a=>e.jsx("span",{className:"star ".concat(a<=s?"active":""),children:"â­"},a))}),e.jsxs("div",{className:"score-grid",children:[e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:i("memory.moves")}),e.jsx("div",{className:"score-value",children:x})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:i("memory.time")}),e.jsx("div",{className:"score-value accent",children:T(M)})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:i("memory.pairs")}),e.jsx("div",{className:"score-value streak",children:g})]})]}),e.jsxs($,{expand:"block",className:"play-again-btn",onClick:k,children:[e.jsx(N,{icon:G,slot:"start"}),i("game.playAgain")]}),e.jsx($,{expand:"block",fill:"outline",routerLink:"/home",className:"home-btn",children:i("review.backToHome")})]}),e.jsx(R,{})]})})]})}return e.jsxs(S,{children:[e.jsx(E,{title:i("memory.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(F,{className:"ion-padding memory-content",children:e.jsxs("div",{className:"memory-container",children:[e.jsxs("div",{className:"memory-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:i("memory.moves")}),e.jsx("span",{className:"stat-value",children:x})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx(N,{icon:H,className:"time-icon"}),e.jsx("span",{className:"stat-value",children:T(M)})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:i("memory.matched")}),e.jsxs("span",{className:"stat-value",children:[g,"/",h]})]})]}),e.jsx("div",{className:"memory-grid",children:o.map(s=>e.jsx("div",{className:"memory-card ".concat(s.isFlipped?"flipped":""," ").concat(s.isMatched?"matched":""),onClick:()=>B(s.id),children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-front",children:e.jsx("span",{className:"card-icon",children:"?"})}),e.jsxs("div",{className:"card-back ".concat(s.type),children:[e.jsx("span",{className:"card-text",children:s.content}),e.jsx("span",{className:"card-type-label",children:s.type==="tagalog"?"ðŸ‡µðŸ‡­":"ðŸ“–"})]})]})},s.id))})]})})]})};export{K as default};
