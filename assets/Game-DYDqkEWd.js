import{u as D,r,j as e,I as b,a as k,b as g,d as G}from"./index-CKL-55qS.js";import{y as F,r as P,n as Q,o as U}from"./index-u5fJ2iny.js";import{C as S}from"./CommonHeader-DOr3u8wB.js";import{F as W}from"./Footer-B7IN8Wc9.js";import{l as _}from"./lessons-BXRLNH_M.js";const J=()=>_.flatMap(a=>a.cards),w=a=>{const l=[...a];for(let i=l.length-1;i>0;i--){const n=Math.floor(Math.random()*(i+1));[l[i],l[n]]=[l[n],l[i]]}return l},x=10,Z=()=>{const{t:a,i18n:l}=D(),i=r.useMemo(()=>J(),[]),[n,I]=r.useState(0),[f,A]=r.useState(0),[O,N]=r.useState(0),[T,y]=r.useState(0),[m,p]=r.useState(null),[B,v]=r.useState(null),[d,H]=r.useState([]),[q,z]=r.useState([]),[R,M]=r.useState(!1),j=s=>{switch(l.language){case"zh-TW":return s.zhTW||s.english;case"zh-CN":return s.zhCN||s.english;default:return s.english}},E=()=>{const s=w(i).slice(0,x);H(s),I(0),A(0),N(0),y(0),p(null),v(null),M(!1)};r.useEffect(()=>{if(d.length===0){E();return}if(n>=d.length){M(!0);return}const s=d[n],u=j(s),h=i.filter(t=>t.id!==s.id),o=w(h).slice(0,3).map(t=>j(t)),c=w([u,...o]);z(c),p(null),v(null)},[n,d,l.language]);const $=s=>{if(m!==null)return;const u=d[n],h=j(u),o=s===h;p(s),v(o),o?(A(c=>c+1),N(c=>{const t=c+1;return t>T&&y(t),t})):N(0),setTimeout(()=>{I(c=>c+1)},1200)},C=d[n];if(R){const s=Math.round(f/x*100);return e.jsxs(b,{children:[e.jsx(S,{title:a("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsxs("div",{className:"game-over-container fade-in-up",children:[e.jsxs("div",{className:"game-over-card",children:[e.jsx("div",{className:"trophy-icon",children:e.jsx(g,{icon:F})}),e.jsx("h2",{children:a("game.roundComplete")}),e.jsx("p",{className:"game-over-subtitle",children:a("game.greatJob")}),e.jsxs("div",{className:"score-grid",children:[e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:a("game.finalScore")}),e.jsxs("div",{className:"score-value",children:[f,"/",x]})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:a("game.accuracy")}),e.jsxs("div",{className:"score-value accent",children:[s,"%"]})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:a("game.bestStreak")}),e.jsxs("div",{className:"score-value streak",children:["ðŸ”¥ ",T]})]})]}),e.jsxs(G,{expand:"block",className:"play-again-btn",onClick:E,children:[e.jsx(g,{icon:P,slot:"start"}),a("game.playAgain")]}),e.jsx(G,{expand:"block",fill:"outline",routerLink:"/home",className:"home-btn",children:a("review.backToHome")})]}),e.jsx(W,{})]})})]})}return C?e.jsxs(b,{children:[e.jsx(S,{title:a("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsxs("div",{className:"game-container",children:[e.jsxs("div",{className:"game-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:"".concat(n/x*100,"%")}})}),e.jsxs("div",{className:"progress-text",children:[n+1," / ",x]})]}),e.jsxs("div",{className:"game-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:a("game.score")}),e.jsx("span",{className:"stat-value",children:f})]}),O>0&&e.jsxs("div",{className:"stat-item streak-indicator",children:[e.jsx("span",{className:"streak-fire",children:"ðŸ”¥"}),e.jsx("span",{className:"stat-value",children:O})]})]}),e.jsxs("div",{className:"question-card ".concat(B===!0?"correct":""," ").concat(B===!1?"incorrect":""),children:[e.jsx("div",{className:"question-label",children:a("game.whatDoesThisMean")}),e.jsx("h2",{className:"question-word",children:C.tagalog})]}),e.jsx("div",{className:"options-grid",children:q.map((s,u)=>{const h=j(C),o=s===h,c=m===s;let t="option-btn";return m!==null&&(o?t+=" correct":c?t+=" incorrect":t+=" disabled"),e.jsxs("button",{className:t,onClick:()=>$(s),disabled:m!==null,children:[e.jsx("span",{className:"option-text",children:s}),m!==null&&o&&e.jsx(g,{icon:Q,className:"result-icon correct"}),c&&!o&&e.jsx(g,{icon:U,className:"result-icon incorrect"})]},u)})})]})})]}):e.jsxs(b,{children:[e.jsx(S,{title:a("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsx("div",{className:"loading-container",children:e.jsx("p",{children:a("game.loading")})})})]})};export{Z as default};
