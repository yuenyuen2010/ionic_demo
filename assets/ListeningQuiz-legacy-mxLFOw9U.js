System.register(["./index-legacy-BlBWNhfL.js","./index-legacy-DgtzNASK.js","./CommonHeader-legacy-CHurDPYf.js","./lessons-legacy-ABE7m_Co.js"],function(e,n){"use strict";var a,t,i,o,s,r,l,c,d,g,p,x,f,m,u;return{setters:[e=>{a=e.u,t=e.r,i=e.j,o=e.I,s=e.b,r=e.c,l=e.e},e=>{c=e.o,d=e.v,g=e.E,p=e.F,x=e.r,f=e.h},e=>{m=e.C},e=>{u=e.l}],execute:function(){var n=document.createElement("style");n.textContent=".listening-game-content{--background: linear-gradient(180deg, #dbeafe 0%, #93c5fd 50%, #3b82f6 100%)}.listening-game-container{padding:100px 20px 40px;min-height:100vh;display:flex;flex-direction:column;gap:20px}.listening-progress-bar{width:100%;height:8px;background:rgba(255,255,255,.5);border-radius:10px;overflow:hidden}.listening-progress-fill{height:100%;background:linear-gradient(90deg,#2563eb,#1d4ed8);border-radius:10px;transition:width .5s ease}.listening-stats-row{display:flex;justify-content:center;gap:24px;flex-wrap:wrap}.listening-stat{display:flex;flex-direction:column;align-items:center;background:rgba(255,255,255,.9);padding:8px 16px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1)}.stat-label{font-size:.7rem;font-weight:600;text-transform:uppercase;color:#64748b;letter-spacing:.05em}.stat-value{font-size:1.1rem;font-weight:800;color:#1e293b}.audio-player-card{background:#fff;padding:40px 30px;border-radius:28px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.15);margin:10px 0}.play-audio-btn{width:100px;height:100px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;color:#fff;font-size:40px;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;cursor:pointer;box-shadow:0 8px 24px rgba(59,130,246,.4);transition:all .3s ease}.play-audio-btn:hover:not(:disabled){transform:scale(1.05);box-shadow:0 12px 32px rgba(59,130,246,.5)}.play-audio-btn:active:not(:disabled){transform:scale(.95)}.play-audio-btn.playing{animation:pulse-audio 1s ease-in-out infinite}.play-audio-btn:disabled{opacity:.7;cursor:not-allowed}.audio-hint{font-size:1rem;font-weight:600;color:#64748b;margin:0}.listening-options-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.listening-option{position:relative;background:#fff;border:3px solid transparent;border-radius:16px;padding:16px;font-size:1rem;color:#1e293b;cursor:pointer;transition:all .2s ease;box-shadow:0 4px 12px rgba(0,0,0,.08);display:flex;flex-direction:column;align-items:center;gap:4px;text-align:center}.listening-option:hover:not(:disabled):not(.disabled){transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.12);border-color:#3b82f6}.listening-option:active:not(:disabled):not(.disabled){transform:translateY(0)}.listening-option.disabled{opacity:.5;cursor:not-allowed}.listening-option.correct{background:linear-gradient(135deg,#22c55e,#16a34a);border-color:#16a34a;color:#fff;animation:correctPop .4s ease}.listening-option.wrong{background:linear-gradient(135deg,#ef4444,#dc2626);border-color:#dc2626;color:#fff;animation:shake .4s ease}.listening-option.faded{opacity:.5}.option-tagalog{font-size:1.1rem;font-weight:700}.option-english{font-size:.8rem;opacity:.7}.listening-option.correct .option-english,.listening-option.wrong .option-english{color:rgba(255,255,255,.8)}.result-icon{position:absolute;top:8px;right:8px;font-size:1.3rem}.result-icon.correct,.result-icon.wrong{color:#fff}.listening-feedback{display:flex;align-items:center;justify-content:center;gap:10px;padding:16px 24px;border-radius:16px;background:#fff;box-shadow:0 4px 16px rgba(0,0,0,.1);animation:slideUp .3s ease}.listening-feedback.correct{background:linear-gradient(135deg,#dcfce7,#bbf7d0)}.listening-feedback.wrong{background:linear-gradient(135deg,#fee2e2,#fecaca)}.feedback-emoji{font-size:1.5rem}.feedback-text{font-size:1rem;font-weight:700;color:#1e293b}.listening-game-over{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:100px 20px 40px}.listening-game-over .game-over-card{background:#fff;border-radius:32px;padding:40px 30px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.15);max-width:400px;width:100%}.listening-game-over .score-emoji{font-size:5rem;margin-bottom:16px;animation:bounce .6s ease}.listening-game-over .score-title{font-size:1.6rem;font-weight:800;color:#1e293b;margin:0 0 24px}.listening-game-over .final-score{margin-bottom:24px}.listening-game-over .score-circle{display:inline-flex;flex-direction:column;align-items:center;justify-content:center;width:120px;height:120px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border-radius:50%;box-shadow:0 8px 24px rgba(59,130,246,.4)}.listening-game-over .score-number{font-size:3rem;font-weight:900;color:#fff;line-height:1}.listening-game-over .score-total{font-size:1.2rem;font-weight:600;color:rgba(255,255,255,.8)}.listening-game-over .game-over-actions{display:flex;flex-direction:column;gap:12px}.listening-game-over .play-again-btn{--background: linear-gradient(135deg, #3b82f6, #1d4ed8);--border-radius: 14px;--box-shadow: 0 4px 16px rgba(59, 130, 246, .4);font-weight:700;height:52px}.listening-game-over .home-btn{--border-radius: 14px;--border-color: #d4d4d4;--color: #525252;font-weight:600;height:48px}@keyframes correctPop{0%{transform:scale(1)}50%{transform:scale(1.05)}to{transform:scale(1)}}@keyframes shake{0%,to{transform:translate(0)}20%,60%{transform:translate(-5px)}40%,80%{transform:translate(5px)}}@keyframes slideUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse-audio{0%,to{transform:scale(1);box-shadow:0 8px 24px rgba(59,130,246,.4)}50%{transform:scale(1.1);box-shadow:0 12px 36px rgba(59,130,246,.6)}}@keyframes bounce{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}@media (max-width: 500px){.play-audio-btn{width:80px;height:80px;font-size:32px}.listening-option{padding:12px 10px}.option-tagalog{font-size:1rem}.option-english{font-size:.7rem}.listening-game-over .score-circle{width:100px;height:100px}.listening-game-over .score-number{font-size:2.5rem}}\n/*$vite$:1*/",document.head.appendChild(n);const b=e=>{const n=[...e];for(let a=n.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[n[a],n[e]]=[n[e],n[a]]}return n},h=10;e("default",()=>{const{t:e}=a(),n=t.useRef(null),[w,y]=t.useState([]),[j,v]=t.useState(0),[k,N]=t.useState(0),[z,C]=t.useState(null),[S,T]=t.useState(null),[A,E]=t.useState(!1),[Y,$]=t.useState(!1),[H,P]=t.useState(!1),L=t.useCallback(()=>{const e=(()=>{const e=[];return u.forEach(n=>{n.cards.forEach(n=>{n.tagalog.split(" ").length<=3&&e.push({tagalog:n.tagalog,english:n.english})})}),e})();return b(e).slice(0,h).map(n=>{const a=b(e.filter(e=>e.tagalog!==n.tagalog)).slice(0,3),t=b([n,...a]);return{word:n,options:t}})},[]),B=t.useCallback(()=>{const e=L();y(e),v(0),N(0),C(null),T(null),E(!1),P(!1)},[L]);t.useEffect(()=>{B()},[B]);const M=w[j],O=async()=>{if(!M||Y)return;$(!0),P(!0);const e=M.word.tagalog;try{var a;const t=await fetch("/ionic_demo/audio/audio-map.json"),i=null===(a=(await t.json())[e])||void 0===a?void 0:a.normal;if(i){const a=`/ionic_demo/${i}`;if(n.current)return n.current.src=a,n.current.onended=()=>$(!1),n.current.onerror=()=>{console.log("Local audio failed, trying Cloud TTS"),U(e)},void(await n.current.play())}else console.log("No local audio found, trying Cloud TTS")}catch(t){console.log("Audio map fetch failed:",t)}U(e)},U=async e=>{try{const n=await fetch("https://tts-server-479744148035.asia-east1.run.app/tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,languageCode:"fil-PH",voiceName:"fil-PH-Standard-A"})});if(n.ok){const e=await n.json();if(e.audioContent){const n=new Audio(`data:audio/mp3;base64,${e.audioContent}`);return n.onended=()=>$(!1),n.onerror=()=>$(!1),void n.play()}}}catch(n){console.error("Cloud TTS failed:",n)}$(!1)};return t.useEffect(()=>{if(M&&!A){const e=setTimeout(()=>{O()},500);return()=>clearTimeout(e)}},[j,w]),M||A?i.jsxs(o,{children:[i.jsx(m,{title:e("listening.title"),showBackButton:!0,defaultHref:"/home"}),i.jsx("audio",{ref:n}),i.jsx(s,{className:"listening-game-content",children:A?i.jsx("div",{className:"listening-game-over",children:i.jsxs("div",{className:"game-over-card",children:[i.jsx("div",{className:"score-emoji",children:(()=>{const e=k/h*100;return 100===e?"üèÜ":e>=80?"üåü":e>=60?"üòä":e>=40?"üí™":"üìö"})()}),i.jsx("h2",{className:"score-title",children:(()=>{const n=k/h*100;return e(100===n?"listening.perfect":n>=80?"listening.excellent":n>=60?"listening.good":n>=40?"listening.keepLearning":"listening.tryAgain")})()}),i.jsx("div",{className:"final-score",children:i.jsxs("div",{className:"score-circle",children:[i.jsx("span",{className:"score-number",children:k}),i.jsxs("span",{className:"score-total",children:["/ ",h]})]})}),i.jsxs("div",{className:"game-over-actions",children:[i.jsxs(l,{expand:"block",onClick:B,className:"play-again-btn",children:[i.jsx(r,{icon:x,slot:"start"}),e("listening.playAgain")]}),i.jsxs(l,{expand:"block",fill:"outline",routerLink:"/home",className:"home-btn",children:[i.jsx(r,{icon:f,slot:"start"}),e("common.backToHome")]})]})]})}):i.jsxs("div",{className:"listening-game-container",children:[i.jsx("div",{className:"listening-progress-bar",children:i.jsx("div",{className:"listening-progress-fill",style:{width:(j+1)/h*100+"%"}})}),i.jsxs("div",{className:"listening-stats-row",children:[i.jsxs("div",{className:"listening-stat",children:[i.jsx("span",{className:"stat-label",children:e("listening.question")}),i.jsxs("span",{className:"stat-value",children:[j+1,"/",h]})]}),i.jsxs("div",{className:"listening-stat",children:[i.jsx("span",{className:"stat-label",children:e("listening.score")}),i.jsx("span",{className:"stat-value",children:k})]})]}),i.jsxs("div",{className:"audio-player-card",children:[i.jsx("button",{className:"play-audio-btn "+(Y?"playing":""),onClick:O,disabled:Y,children:i.jsx(r,{icon:Y?c:d})}),i.jsx("p",{className:"audio-hint",children:e(H?"listening.tapAgain":"listening.tapToListen")})]}),i.jsx("div",{className:"listening-options-grid",children:M.options.map((e,n)=>{let a="listening-option";return null!==z&&(e.tagalog===M.word.tagalog?a+=" correct":e.tagalog!==z||S?a+=" faded":a+=" wrong"),H||(a+=" disabled"),i.jsxs("button",{className:a,onClick:()=>(e=>{if(null!==z||!H)return;C(e);const n=e===M.word.tagalog;T(n),n&&N(e=>e+1),setTimeout(()=>{j+1>=h?E(!0):(v(e=>e+1),C(null),T(null),P(!1))},2e3)})(e.tagalog),disabled:null!==z||!H,children:[i.jsx("span",{className:"option-tagalog",children:e.tagalog}),i.jsx("span",{className:"option-english",children:e.english}),null!==z&&e.tagalog===M.word.tagalog&&i.jsx(r,{icon:g,className:"result-icon correct"}),z===e.tagalog&&!S&&i.jsx(r,{icon:p,className:"result-icon wrong"})]},n)})}),null!==z&&i.jsxs("div",{className:"listening-feedback "+(S?"correct":"wrong"),children:[i.jsx("span",{className:"feedback-emoji",children:S?"‚úÖ":"‚ùå"}),i.jsx("span",{className:"feedback-text",children:S?e("listening.correct"):`${e("listening.wrong")} ${M.word.tagalog}`})]})]})})]}):null})}}});
