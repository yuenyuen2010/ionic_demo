import{u as D,r,j as e,I as b,b as k,c as g,e as G}from"./index-BLtOpwuz.js";import{B as F,r as P,t as Q,u as U}from"./index-CEQkXYGf.js";import{C as S}from"./CommonHeader-CVm9cG9x.js";import{F as W}from"./Footer-XGm7XsF3.js";import{l as _}from"./lessons-DH3gilkg.js";const J=()=>_.flatMap(t=>t.cards),w=t=>{const l=[...t];for(let i=l.length-1;i>0;i--){const n=Math.floor(Math.random()*(i+1));[l[i],l[n]]=[l[n],l[i]]}return l},x=10,Z=()=>{const{t,i18n:l}=D(),i=r.useMemo(()=>J(),[]),[n,I]=r.useState(0),[f,A]=r.useState(0),[O,N]=r.useState(0),[B,T]=r.useState(0),[m,p]=r.useState(null),[y,v]=r.useState(null),[d,H]=r.useState([]),[q,z]=r.useState([]),[R,M]=r.useState(!1),j=s=>{switch(l.language){case"zh-TW":return s.zhTW||s.english;case"zh-CN":return s.zhCN||s.english;default:return s.english}},E=()=>{const s=w(i).slice(0,x);H(s),I(0),A(0),N(0),T(0),p(null),v(null),M(!1)};r.useEffect(()=>{if(d.length===0){E();return}if(n>=d.length){M(!0);return}const s=d[n],u=j(s),h=i.filter(a=>a.id!==s.id),o=w(h).slice(0,3).map(a=>j(a)),c=w([u,...o]);z(c),p(null),v(null)},[n,d,l.language]);const $=s=>{if(m!==null)return;const u=d[n],h=j(u),o=s===h;p(s),v(o),o?(A(c=>c+1),N(c=>{const a=c+1;return a>B&&T(a),a})):N(0),setTimeout(()=>{I(c=>c+1)},1200)},C=d[n];if(R){const s=Math.round(f/x*100);return e.jsxs(b,{children:[e.jsx(S,{title:t("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsxs("div",{className:"game-over-container fade-in-up",children:[e.jsxs("div",{className:"game-over-card",children:[e.jsx("div",{className:"trophy-icon",children:e.jsx(g,{icon:F})}),e.jsx("h2",{children:t("game.roundComplete")}),e.jsx("p",{className:"game-over-subtitle",children:t("game.greatJob")}),e.jsxs("div",{className:"score-grid",children:[e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:t("game.finalScore")}),e.jsxs("div",{className:"score-value",children:[f,"/",x]})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:t("game.accuracy")}),e.jsxs("div",{className:"score-value accent",children:[s,"%"]})]}),e.jsxs("div",{className:"score-item",children:[e.jsx("div",{className:"score-label",children:t("game.bestStreak")}),e.jsxs("div",{className:"score-value streak",children:["ðŸ”¥ ",B]})]})]}),e.jsxs(G,{expand:"block",className:"play-again-btn",onClick:E,children:[e.jsx(g,{icon:P,slot:"start"}),t("game.playAgain")]}),e.jsx(G,{expand:"block",fill:"outline",routerLink:"/home",className:"home-btn",children:t("review.backToHome")})]}),e.jsx(W,{})]})})]})}return C?e.jsxs(b,{children:[e.jsx(S,{title:t("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsxs("div",{className:"game-container",children:[e.jsxs("div",{className:"game-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:"".concat(n/x*100,"%")}})}),e.jsxs("div",{className:"progress-text",children:[n+1," / ",x]})]}),e.jsxs("div",{className:"game-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:t("game.score")}),e.jsx("span",{className:"stat-value",children:f})]}),O>0&&e.jsxs("div",{className:"stat-item streak-indicator",children:[e.jsx("span",{className:"streak-fire",children:"ðŸ”¥"}),e.jsx("span",{className:"stat-value",children:O})]})]}),e.jsxs("div",{className:"question-card ".concat(y===!0?"correct":""," ").concat(y===!1?"incorrect":""),children:[e.jsx("div",{className:"question-label",children:t("game.whatDoesThisMean")}),e.jsx("h2",{className:"question-word",children:C.tagalog})]}),e.jsx("div",{className:"options-grid",children:q.map((s,u)=>{const h=j(C),o=s===h,c=m===s;let a="option-btn";return m!==null&&(o?a+=" correct":c?a+=" incorrect":a+=" disabled"),e.jsxs("button",{className:a,onClick:()=>$(s),disabled:m!==null,children:[e.jsx("span",{className:"option-text",children:s}),m!==null&&o&&e.jsx(g,{icon:Q,className:"result-icon correct"}),c&&!o&&e.jsx(g,{icon:U,className:"result-icon incorrect"})]},u)})})]})})]}):e.jsxs(b,{children:[e.jsx(S,{title:t("game.title"),showBackButton:!0,defaultHref:"/home"}),e.jsx(k,{className:"ion-padding game-content",children:e.jsx("div",{className:"loading-container",children:e.jsx("p",{children:t("game.loading")})})})]})};export{Z as default};
